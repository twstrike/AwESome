package aes

import (
	. "gopkg.in/check.v1"
)

type SubBytesTestSuite struct{}

var _ = Suite(&SubBytesTestSuite{})

func (s *SubBytesTestSuite) TestSubBytes(c *C) {
	oldState := state{
		0xf0, 0xe1, 0xd2, 0xc3,
		0xb4, 0xa5, 0x96, 0x87,
		0x78, 0x69, 0x5a, 0x4b,
		0x3c, 0x2d, 0x1e, 0x0f,
	}
	newState := state{
		0x8c, 0xf8, 0xb5, 0x2e,
		0x8d, 0x06, 0x90, 0x17,
		0xbc, 0xf9, 0xbe, 0xb3,
		0xeb, 0xd8, 0x72, 0x76,
	}

	c.Assert(subBytes(oldState), Equals, newState)
}

func (s *SubBytesTestSuite) TestInvSubBytes(c *C) {
	oldState := state{
		0x8c, 0xf8, 0xb5, 0x2e,
		0x8d, 0x06, 0x90, 0x17,
		0xbc, 0xf9, 0xbe, 0xb3,
		0xeb, 0xd8, 0x72, 0x76,
	}
	newState := state{
		0xf0, 0xe1, 0xd2, 0xc3,
		0xb4, 0xa5, 0x96, 0x87,
		0x78, 0x69, 0x5a, 0x4b,
		0x3c, 0x2d, 0x1e, 0x0f,
	}

	c.Assert(invSubBytes(oldState), Equals, newState)
}

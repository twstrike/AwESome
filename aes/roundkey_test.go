package aes

import (
	. "gopkg.in/check.v1"
)

type RoundKeyTestSuite struct{}

var _ = Suite(&RoundKeyTestSuite{})

func (s *RoundKeyTestSuite) TestRoundKeyTransformation(c *C) {

	inputState := state{
		0xd3, 0x2d, 0x13, 0x76,
		0x9d, 0x3a, 0x4a, 0x46,
		0x01, 0x23, 0x12, 0x26,
		0x79, 0xb3, 0x50, 0xb2,
	}
	rs := roundSchedule{0xf3cb8b00, 0x92d9ee5a, 0x44ac2068, 0x3d7aaebd}
	outState := state{
		0x20, 0xbf, 0x57, 0x4b,
		0x56, 0xe3, 0xe6, 0x3c,
		0x8a, 0xcd, 0x32, 0x88,
		0x79, 0xe9, 0x38, 0x0f,
	}
	c.Assert(addRoundKey(inputState, rs), Equals, outState)
}

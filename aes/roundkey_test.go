package aes

import (
	. "gopkg.in/check.v1"
)

type RoundKeyTestSuite struct{}

var _ = Suite(&RoundKeyTestSuite{})

func (s *RoundKeyTestSuite) TestRoundKeyTransformation(c *C) {

	inputState := state{
		0x8E, 0xC6, 0x4D, 0x01,
		0x4D, 0xC6, 0x7E, 0x01,
		0xA1, 0xC6, 0xBD, 0x01,
		0xBC, 0xC6, 0xF8, 0x01,
	}
	rs := roundSchedule{0x2b7e1516, 0x28aed2a6, 0xabf71588, 0x09cf4f3c}
	outState := state{
		0xa5, 0xee, 0xe6, 0x08,
		0x33, 0x68, 0x89, 0xce,
		0xb4, 0x14, 0xa8, 0x4e,
		0xaa, 0x60, 0x70, 0x3d,
	}
	c.Assert(addRoundKey(inputState, rs), Equals, outState)
}
